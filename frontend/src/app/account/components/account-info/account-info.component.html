<div class="header">
    <h1 class="h3">{{ 'app.account.accountInfo.title' | translate }}</h1>

    <div class="header-controls d-none d-lg-block">
        <fingather-portfolio-selector />
    </div>
</div>

<div class="content-center">
    @if(user(); as user) {
        @if (editing()) {
            <div class="card form">
                <div class="card-body">
                    <form [formGroup]="form" (ngSubmit)="onSubmit()">
                        <div class="form-row">
                            <div class="form-group col">
                                <label for="name">{{ 'app.account.accountInfo.name' | translate }}</label>
                                <input id="name" type="text" formControlName="name" class="form-control" [class.is-invalid]="submitted() && f['name'].errors" />
                                <fingather-input-validator
                                    [control]="f['name']"
                                    [isSubmitted]="submitted()"
                                    [errorMessages]="{
                                        required: 'app.account.accountInfo.nameRequired',
                                    }"
                                />
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col">
                                <label for="email">{{ 'app.account.accountInfo.email' | translate }}</label>
                                <input id="email" type="text" formControlName="email" class="form-control" [class.is-invalid]="submitted() && f['email'].errors" />
                                <fingather-input-validator
                                    [control]="f['email']"
                                    [isSubmitted]="submitted()"
                                    [errorMessages]="{
                                        required: 'app.account.accountInfo.emailRequired',
                                        email: 'app.account.accountInfo.emailIsEmail',
                                        uniqueEmail: 'app.account.accountInfo.emailExists',
                                    }"
                                />
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col">
                                <label for="password">
                                    {{ 'app.account.accountInfo.password' | translate }}
                                    <em>{{ 'app.account.accountInfo.passwordLeaveBlank' | translate }}</em>
                                </label>
                                <input id="password" type="password" formControlName="password" class="form-control" [class.is-invalid]="submitted() && f['password'].errors" />
                                <fingather-input-validator
                                    [control]="f['password']"
                                    [isSubmitted]="submitted()"
                                    [errorMessages]="{
                                        minlength: 'app.account.accountInfo.passwordLength',
                                    }"
                                />
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col">
                                <label for="emailNotifications">{{ 'app.account.accountInfo.emailNotifications' | translate }}</label>
                                <div class="form-check form-switch">
                                    <input
                                        formControlName="isEmailNotificationsEnabled"
                                        class="form-check-input"
                                        type="checkbox"
                                        role="switch"
                                        id="emailNotifications"
                                    >
                                </div>
                            </div>
                        </div>
                        <div class="form-group buttons">
                            <button type="button" class="btn btn-secondary" (click)="onCancelEdit()">{{ 'app.common.cancel' | translate }}</button>

                            <fingather-save-button
                                [saving]="saving()"
                            />
                        </div>
                    </form>
                </div>
            </div>
        } @else {
            <div class="account">
                <div class="card">
                    <div class="card-body">

                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="color-gray">{{ 'app.account.accountInfo.name' | translate }}</td>
                                    <td>{{ user.name }}</td>
                                </tr>
                                <tr>
                                    <td class="color-gray">{{ 'app.account.accountInfo.email' | translate }}</td>
                                    <td>{{ user.email }}</td>
                                </tr>
                                <tr>
                                    <td class="color-gray">{{ 'app.account.accountInfo.emailNotifications' | translate }}</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input
                                                class="form-check-input"
                                                type="checkbox"
                                                role="switch"
                                                [checked]="user.isEmailNotificationsEnabled"
                                            >
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="form-group buttons mt-4">
                            <button type="button" class="btn btn-primary" (click)="onEdit()">{{ 'app.common.edit' | translate }}</button>
                            <fingather-delete-button
                                [title]="'app.account.accountInfo.deleteAccount' | translate"
                                [message]="'app.account.accountInfo.deleteAccountMessage' | translate"
                                [text]="'app.account.accountInfo.deleteAccount' | translate"
                                [showText]="true"
                                [showAsLink]="true"
                                (confirm)="deleteAccount()"
                            />
                        </div>
                    </div>
                </div>
            </div>
        }
    }
</div>
