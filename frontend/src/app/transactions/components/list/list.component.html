<div class="header">
    <h1 class="h3">{{ 'app.transactions.list.title' | translate }}</h1>

    <div class="header-controls">
        <div class="header-controls-buttons">
            <a routerLink="add-transaction" class="btn btn-primary" tabindex="0">
                <mat-icon>add</mat-icon>
                <span>{{ 'app.transactions.list.addTransaction' | translate }}</span>
            </a>
            <a routerLink="add-dividend" class="btn btn-primary" tabindex="0">
                <mat-icon>add</mat-icon>
                <span>{{ 'app.transactions.list.addDividend' | translate }}</span>
            </a>
            <a routerLink="import" class="btn btn-secondary">
                <mat-icon>upload</mat-icon>
                <span>{{ 'app.transactions.list.import' | translate }}</span>
            </a>
        </div>

        <div class="d-none d-lg-block">
            <fingather-portfolio-selector />
        </div>
    </div>
</div>

<fingather-transactions-search
    (onSearch)="changeTransactionSearch($event)"
/>

<div class="card">
    <div class="card-body">
        @if (transactionList !== null) {
            <table
                class="table"
                tableGrid
                [columns]="tableGridColumns"
                scrollShadow
            >
                <thead>
                    <tr>
                        <th>{{ 'app.transactions.list.date' | translate }}</th>
                        <th>{{ 'app.transactions.list.created' | translate }}</th>
                        <th>{{ 'app.transactions.list.type' | translate }}</th>
                        <th>{{ 'app.transactions.list.asset' | translate }}</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @for(transaction of transactionList?.transactions; track transaction.id) {
                        <tr>
                            <td class="color-gray">
                                <div class="text-nowrap">{{transaction.actionCreated | date: 'y-MM-dd'}}</div>
                                <div class="small">{{transaction.actionCreated | date: 'HH:mm'}}</div>
                            </td>
                            <td class="color-gray">
                                <div class="text-nowrap">{{transaction.created | date: 'y-MM-dd'}}</div>
                                <div class="small">{{transaction.created | date: 'HH:mm'}}</div>
                            </td>
                            <td>
                                <fingather-tag [type]="transaction.actionType" />
                            </td>
                            <td>
                                <div class="asset">
                                    <fingather-ticker-logo
                                        [ticker]="transaction.ticker"
                                        [width]="46"
                                        [height]="46"
                                    />
                                    <div class="asset-text">
                                        <div class="asset-ticker">{{transaction.ticker.ticker}}</div>
                                        <div class="asset-name ellipsis">{{transaction.ticker.name}}</div>
                                    </div>
                                </div>
                            </td>
                            <td class="actions">
                                @if (transaction.actionType === TransactionActionType.Dividend) {
                                    <a routerLink="edit-dividend/{{transaction.id}}" class="btn btn-secondary" tabindex="0">
                                        <mat-icon>edit</mat-icon>
                                    </a>
                                } @else {
                                    <a routerLink="edit-transaction/{{transaction.id}}" class="btn btn-secondary" tabindex="0">
                                        <mat-icon>edit</mat-icon>
                                    </a>
                                }
                                <fingather-delete-button
                                    (onConfirm)="deleteTransaction(transaction.id)"
                                    [title]="'Delete transaction'"
                                    [message]="'Are you sure you want to delete transaction?'"
                                />
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
</div>

<fingather-pagination
    [totalItems]="transactionList !== null ? transactionList.count : 0"
    [defaultPageSize]="pageSize"
    (onSelectPage)="changePage($event)"
    (onChangePageSize)="changePageSize($event)"
/>
